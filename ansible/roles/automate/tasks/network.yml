- name: Copy NFTables configuration
  template:
    src: "etc/nftables.conf.j2"
    dest: "/etc/nftables.conf"
    force: yes
    owner: "root"
    group: "root"
    mode: 0600
    validate: "nft -c -f %s"
  notify: reload nftables

- name: Enable NFTables
  systemd:
    name: "nftables.service"
    state: "started"
    enabled: yes

- name: Update hosts file
  blockinfile:
    state: "present"
    path: "/etc/hosts"
    block: |
      {{ living_room_tv_ip }} tv-lr.devices.local
      {{ living_room_home_ip }} home-lr.devices.local
      {{ lounge_cast_ip }} cast-lounge.devices.local
      {{ lounge_home_ip }} home-lounge.devices.local
      {{ lounge_broadlink_ip }} broadlink-lounge.devices.local
      {{ laundry_home_ip }} home-laundry.devices.local
      {{ master_bedroom_home_ip }} home-mbr.devices.local
